import { useState, useEffect } from 'react'
import { useParams, useNavigate } from 'react-router-dom'
import {
  Container,
  Paper,
  Typography,
  Box,
  IconButton,
  Divider,
  Stack
} from '@mui/material'
import {
  ArrowBack as ArrowBackIcon,
  Gavel as GavelIcon,
  AdminPanelSettings as AdminIcon
} from '@mui/icons-material'
import { checkGroupAccess } from '../lib/api'

const ADMIN_RULES = [
  'ุตุงุญุจ ุงููููุน ูู ุงูุญู ุงููุงูู ูู ุฅุฏุงุฑุฉ ูู ุดูุก ุฏุงุฎู ุงูุฌุฑูุจุ ุจูุง ูู ุฐูู: ุชุนุฏูู ุงุณู ุงูุฌุฑูุจุ ูุตููุ ุตูุฑูุ ูุฅุนุฏุงุฏุงุชู.',
  'ุตุงุญุจ ุงููููุน ููููู ุฅุถุงูุฉ ุฃู ุฅุฒุงูุฉ ุฃู ุนุถู ูู ุงูุฌุฑูุจ ูู ุฃู ููุช ุฏูู ุงูุญุงุฌุฉ ูููุงููุฉ ุฃุญุฏ.',
  'ุตุงุญุจ ุงููููุน ูู ุงูุญู ูู ุชุนููู ุฃู ุฅูุบุงุก ุฃู ุฃุฏูู ุฃู ูุดุฑู ุญุณุจ ุฑุคูุชู ูุฅุฏุงุฑุฉ ุงูุฌุฑูุจ.',
  'ุตุงุญุจ ุงููููุน ูุณุคูู ุนู ูุฑุงูุจุฉ ุงููุญุชูู ูุถูุงู ุงูุชุฒุงู ุงูุฃุนุถุงุก ุจุงูููุงููู.',
  'ุฃู ูุฎุงููุฉ ููููุงููู ูููู ูุตุงุญุจ ุงููููุน ุงูุชุนุงูู ูุนูุง ูุจุงุดุฑุฉุ ุจูุง ูู ุฐูู ุงูุชุญุฐูุฑ ุฃู ุงูุญุธุฑ ุงูููุงุฆู.',
  'ุตุงุญุจ ุงููููุน ูู ุงูุญู ูู ุญุฐู ุฃู ุชุนุฏูู ุฃู ููุดูุฑ ุฃู ุชุนููู ูุฃู ุณุจุจ ูุฑุงู ููุงุณุจูุง.',
  'ุตุงุญุจ ุงููููุน ูู ุงูุญู ูู ุฅุฏุงุฑุฉ ุฌููุน ุงููููุงุชุ ุงูุตูุฑุ ูุงูููุฏูููุงุช ุงููุฑููุนุฉ ูู ุงูุฌุฑูุจ.',
  'ุตุงุญุจ ุงููููุน ูู ุงูุญู ูู ุฅุฏุงุฑุฉ ุฃู ููุฒุฉ ุชูููุฉ ุฏุงุฎู ุงูุฌุฑูุจุ ูุซู ุงุณุชูุชุงุกุงุชุ ูุณุงุจูุงุชุ ุฃู ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ.',
  'ุตุงุญุจ ุงููููุน ูู ุงูุญู ูู ุชุญุฏูุซ ุงูููุงููู ูุฅุถุงูุฉ ุฃู ููุงุนุฏ ุฌุฏูุฏุฉ ูุฅุฎุจุงุฑ ุงูุฃุนุถุงุก ุจูุง.',
  'ุฌููุน ูุฑุงุฑุงุช ุตุงุญุจ ุงููููุน ููุงุฆูุฉ ูููุฒูุฉ ูุฌููุน ุงูุฃุนุถุงุก ูุงูุฅุฏููุฒ ุฏุงุฎู ุงูุฌุฑูุจ.'
]

const GENERAL_RULES = [
  'ูุง ููุณูุญ ุจูุดุฑ ุฃู ูุญุชูู +18ุ ูุฅูุง ุณูุชู ูุนุงูุจุฉ ุตุงุญุจ ุงูุฌุฑูุจ.',
  'ุตุงุญุจ ุงูุฌุฑูุจ ูู ููุท ุงููุงุฏุฑ ุนูู ุชุบููุฑ ุงุณู ุงูุฌุฑูุจ ุฃู ุญุฐูู ุชูุงููุง.',
  'ุฅุฐุง ุชู ุญุฐู ุญุณุงุจ ุตุงุญุจ ุงูุฌุฑูุจ ูุฃู ุณุจุจ ูู ุงูุฃุณุจุงุจ ูุณูู ูููู ุงูุฌุฑูุจ ุจุชุนููู ุฃุฏูู ููุงู ุตุงุญุจ ุงูุฌุฑูุจ.',
  'ูุง ููุณูุญ ุจูุดุฑ ุฑูุงุจุท ุนุดูุงุฆูุฉ ุฃู ุฑุณุงุฆู ุณุจุงู ุฃู ุฅุนูุงูุงุช ุบูุฑ ูุตุฑุญ ุจูุง.',
  'ูุง ููุณูุญ ููุนุถู ุจุงูุชูุงู ุฃูุซุฑ ูู ุญุณุงุจ ูุงุญุฏ ูู ููุณ ุงูุฌุฑูุจ.',
  'ูุง ููุณูุญ ุจุนูู ูุณุงุจูุงุช ุฃู ุงุณุชูุชุงุกุงุช ุฅูุง ุจุนุฏ ููุงููุฉ ุตุงุญุจ ุงูุฌุฑูุจ ุฃู ุฃุญุฏ ุงูุฅุฏููุฒ.',
  'ูู ุญุงู ูุฌูุฏ ุฃู ุชุญุฏูุซุงุช ุฃู ุชุบููุฑุงุช ูู ุงูููุงูููุ ุณูุชู ุฅุฎุจุงุฑ ุงูุฃุนุถุงุก ุจูุง ุฏุงุฎู ุงูุฌุฑูุจ.',
  'ูุฌุจ ุงุญุชุฑุงู ุฌููุน ุงูุฃุนุถุงุก ูุนุฏู ุงุณุชุฎุฏุงู ุฃููุงุธ ูุณูุฆุฉ ุฃู ููููุฉ.',
  'ุงูููุงุดุงุช ุงูุณูุงุณูุฉ ุฃู ุงูุฏูููุฉ ุงููุซูุฑุฉ ููุฌุฏู ููููุนุฉ ูุชุฌูุจ ุงููุฒุงุนุงุช ุจูู ุงูุฃุนุถุงุก.',
  'ูููุถู ุงูุงูุชุฒุงู ุจููุถูุน ุงูุฌุฑูุจ ูุนุฏู ูุดุฑ ูุญุชูู ุบูุฑ ูุชุนูู ุจูุฏูู ุงูุฃุณุงุณู.',
  'ุฃู ูุญุงููุฉ ูุงุฎุชุฑุงู ุฃู ุงุณุชุบูุงู ุซุบุฑุงุช ูู ุงููุธุงู ุณุชุคุฏู ุฅูู ุญุธุฑ ููุฑู ูุฏุงุฆู.',
  'ุงูุฅุฏููุฒ ููู ุงูุญู ูู ุญุฐู ุฃู ููุดูุฑ ุฃู ุชุนููู ูุฑููู ุบูุฑ ููุงุณุจ ุญุชู ูู ูู ููุฐูุฑ ุจุดูู ุตุฑูุญ ูู ุงูููุงููู.',
  'ููููุน ูุดุฑ ูุนูููุงุช ุดุฎุตูุฉ ุนู ุฃู ุนุถู ูุซู ุงูุจุฑูุฏ ุฃู ุฑูู ุงููุงุชู ุจุฏูู ุฅุฐูู.',
  'ููููุน ุงุณุชุฎุฏุงู ุงูุญุณุงุจุงุช ุงููุฒููุฉ ุฃู ุฃุณูุงุก ููููุฉ ุฏุงุฎู ุงูุฌุฑูุจ.',
  'ูู ุญุงูุฉ ุญุฏูุซ ุฎูุงู ุจูู ุงูุฃุนุถุงุก ูุฌุจ ุงูุฑุฌูุน ุฅูู ุตุงุญุจ ุงูุฌุฑูุจ ุฃู ุฃุญุฏ ุงูุฅุฏููุฒ ูุญู ุงููุดููุฉ.',
  'ููููุน ูุดุฑ ูุญุชูู ููุนุงุฏ ูุดุฑู ุจูุซุฑุฉ ุจุดูู ูุณุจุจ ุฅุฒุนุงุฌ ูุจุงูู ุงูุฃุนุถุงุก.',
  'ุงูุนุถู ุงูุฐู ูุชู ุทุฑุฏู ูู ุงูุฌุฑูุจ ูุง ูุญู ูู ุงููุทุงูุจุฉ ุจุงูุนูุฏุฉ ุฅูุง ุจููุงููุฉ ุตุงุญุจ ุงูุฌุฑูุจ.',
  'ุฃู ุงูุชุฑุงุญุงุช ูุชุทููุฑ ุงูุฌุฑูุจ ุฃู ุชุนุฏูู ุงูููุงููู ูุชู ููุงูุดุชูุง ูุน ุงูุฅุฏููุฒ ุฃููุงู.',
  'ุนุฏู ุงุณุชุบูุงู ุงูุฌุฑูุจ ููุชุฑููุฌ ููุฌููุนุงุช ุฃู ุตูุญุงุช ุฃุฎุฑู ุจุฏูู ุฅุฐู ููุณุจู.',
  'ูู ุญุงู ุชูุฑุงุฑ ุงููุฎุงููุงุช ูู ุนุถู ูุนููุ ูุญู ููุฅุฏููุฒ ุงุชุฎุงุฐ ุฅุฌุฑุงุกุงุช ุชุฏุฑูุฌูุฉ ุชุจุฏุฃ ุจุงูุชุญุฐูุฑ ูุชูุชูู ุจุงูุญุธุฑ ุงูููุงุฆู.',
  'ุงูุตูุฑ ุฃู ุงูููุฏูููุงุช ุงููุณูุฆุฉ ุฃู ุงูุชู ุชูุชูู ุญููู ุงููุดุฑ ุณูุชู ุญุฐููุง ูุจุงุดุฑุฉ ูุญุธุฑ ูุงุดุฑูุง.',
  'ูุง ููุณูุญ ุจุชุบููุฑ ุตูุฑุฉ ุฃู ูุตู ุงูุฌุฑูุจ ุฅูุง ูู ุฎูุงู ุตุงุญุจ ุงูุฌุฑูุจ ุฃู ุจุฅุฐู ูุจุงุดุฑ ููู.',
  'ุฃู ุนุถู ูุชุณุจุจ ูู ุฅุซุงุฑุฉ ูุดุงูู ูุชูุฑุฑุฉ ุณูุชู ุญุธุฑู ุญุชู ูุฅู ูู ูุฎุงูู ุงูููุงููู ูุตููุง.',
  'ุงูุญูุงุธ ุนูู ุฎุตูุตูุฉ ุงูุฌุฑูุจ ูุงุฌุจุ ููุง ููุณูุญ ุจููู ูุญุชูุงู ุฅูู ุงูุฎุงุฑุฌ ุฅูุง ุจููุงููุฉ ุตุงุญุจ ุงูุฌุฑูุจ.',
  'ุงููุดุงุฑูุฉ ุงูุฅูุฌุงุจูุฉ ูุทููุจุฉุ ูุงูุนุถู ุบูุฑ ุงููุดุท ููุชุฑุงุช ุทูููุฉ ูุฏ ูุชู ุญุฐูู ููุญูุงุธ ุนูู ุชูุงุนู ุงูุฌุฑูุจ.',
  'ูููุน ูุดุฑ ุฃู ูุญุชูู ูุญุชูู ุนูู ุจุฑุงูุฌ ุถุงุฑุฉ ุฃู ุฑูุงุจุท ูุดุจููุฉ ูุฏ ุชุคุฐู ุงูุฃุฌูุฒุฉ ุฃู ุงูุฃุนุถุงุก.',
  'ููุญุธุฑ ุงูุชููุฑ ุฃู ุงููุถุงููุฉ ุงููุณุชูุฑุฉ ูุฃู ุนุถู ูููุง ูุงู ุงูุณุจุจ.',
  'ุงููุดุงุฑูุงุช ูุฌุจ ุฃู ุชููู ูุงุถุญุฉ ููููููุฉุ ูุชุฌูุจ ุงุณุชุฎุฏุงู ูุบุฉ ูุจููุฉ ุฃู ุฑููุฒ ุบูุฑ ูููููุฉ.',
  'ููููุน ูุดุฑ ูุญุชูู ุชุฌุงุฑู ุจุฏูู ููุงููุฉ ุตุงุญุจ ุงูุฌุฑูุจ ุฃู ุฃุญุฏ ุงูุฅุฏููุฒ.',
  'ุฃู ูุญุงููุฉ ูุชุฒููุฑ ุงูุนุถููุงุช ุฃู ุงููุฑุนุฉ ุนูู ุงูููุงูุขุช ุณูุชู ุงูุชุนุงูู ูุนูุง ูุฎุฑู ุฌุณูู ููููุงููู.'
]

export default function GroupRules() {
  const { groupName } = useParams()
  const navigate = useNavigate()
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    checkAccess()
  }, [groupName])

  const checkAccess = async () => {
    try {
      await checkGroupAccess(groupName)
      setLoading(false)
    } catch (err) {
      navigate(`/groups/${groupName}`, { replace: true })
    }
  }

  if (loading) {
    return (
      <Container maxWidth="lg" sx={{ py: 4 }}>
        <Typography textAlign="center">ุฌุงุฑู ุงูุชุญููู...</Typography>
      </Container>
    )
  }

  return (
    <Container maxWidth="md" sx={{ py: 4 }}>
      {/* Header */}
      <Stack direction="row" alignItems="center" spacing={2} mb={4}>
        <IconButton onClick={() => navigate(`/groups/${groupName}/dashboard`)}>
          <ArrowBackIcon />
        </IconButton>
        <GavelIcon sx={{ fontSize: 40, color: 'primary.main' }} />
        <Box>
          <Typography variant="h4" fontWeight={700}>
            ููุงุนุฏ ุงููุฌููุนุฉ
          </Typography>
          <Typography variant="body2" color="text.secondary">
            {groupName}
          </Typography>
        </Box>
      </Stack>

      {/* Admin Rules */}
      <Paper 
        elevation={3}
        sx={{ 
          p: 4, 
          borderRadius: 3, 
          mb: 4,
          background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
          color: 'white'
        }}
      >
        <Stack direction="row" alignItems="center" spacing={2} mb={3}>
          <Box sx={{ 
            bgcolor: 'rgba(255,255,255,0.2)', 
            p: 1.5, 
            borderRadius: 2,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center'
          }}>
            <AdminIcon sx={{ fontSize: 32 }} />
          </Box>
          <Box>
            <Typography variant="h5" fontWeight={700}>
              ุญููู ูุตูุงุญูุงุช ุตุงุญุจ ุงููููุน
            </Typography>
            <Typography variant="body2" sx={{ opacity: 0.9 }}>
              ุตูุงุญูุงุช ูุงููุฉ ูุฅุฏุงุฑุฉ ุงูููุตุฉ
            </Typography>
          </Box>
        </Stack>

        <Box sx={{ bgcolor: 'rgba(255,255,255,0.1)', p: 3, borderRadius: 2 }}>
          {ADMIN_RULES.map((rule, index) => (
            <Box
              key={index}
              sx={{
                mb: 2,
                p: 2,
                bgcolor: 'rgba(255,255,255,0.95)',
                borderRadius: 2,
                transition: 'all 0.3s',
                direction: 'rtl',
                boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                '&:hover': {
                  bgcolor: 'white',
                  transform: 'translateX(-8px)',
                  boxShadow: '0 4px 16px rgba(0,0,0,0.15)'
                }
              }}
            >
              <Typography 
                variant="body1" 
                sx={{ 
                  direction: 'rtl', 
                  textAlign: 'right',
                  color: 'text.primary',
                  lineHeight: 1.8
                }}
              >
                <Box 
                  component="span" 
                  sx={{ 
                    display: 'inline-flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    width: 28,
                    height: 28,
                    borderRadius: '50%',
                    bgcolor: '#667eea',
                    color: 'white',
                    fontWeight: 700,
                    fontSize: '0.9rem',
                    ml: 1.5,
                    mr: 0.5
                  }}
                >
                  {index + 1}
                </Box>
                {rule}
              </Typography>
            </Box>
          ))}
        </Box>
      </Paper>

      {/* General Rules */}
      <Paper elevation={3} sx={{ p: 4, borderRadius: 3, mb: 4 }}>
        <Stack direction="row" alignItems="center" spacing={2} mb={3}>
          <Box sx={{ 
            bgcolor: 'primary.light', 
            p: 1.5, 
            borderRadius: 2,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center'
          }}>
            <Typography fontSize={32}>๐</Typography>
          </Box>
          <Box>
            <Typography variant="h5" fontWeight={700} color="primary">
              ุงูููุงุนุฏ ุงูุนุงูุฉ ูููุฌููุนุฉ
            </Typography>
            <Typography variant="body2" color="text.secondary">
              ููุงุนุฏ ูุฌุจ ุนูู ุฌููุน ุงูุฃุนุถุงุก ุงูุงูุชุฒุงู ุจูุง
            </Typography>
          </Box>
        </Stack>

        <Box sx={{ mt: 3 }}>
          {GENERAL_RULES.map((rule, index) => (
            <Box
              key={index}
              sx={{
                mb: 2,
                p: 2.5,
                bgcolor: index % 2 === 0 ? 'action.hover' : 'transparent',
                borderRadius: 2,
                borderLeft: '4px solid',
                borderColor: 'primary.main',
                transition: 'all 0.3s',
                direction: 'rtl',
                '&:hover': {
                  bgcolor: 'action.selected',
                  transform: 'translateX(-8px)',
                  boxShadow: '0 2px 12px rgba(0,0,0,0.08)'
                }
              }}
            >
              <Typography 
                variant="body1" 
                sx={{ 
                  direction: 'rtl', 
                  textAlign: 'right',
                  lineHeight: 1.8
                }}
              >
                <Box 
                  component="span" 
                  sx={{ 
                    display: 'inline-flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    width: 28,
                    height: 28,
                    borderRadius: '50%',
                    bgcolor: 'primary.main',
                    color: 'white',
                    fontWeight: 700,
                    fontSize: '0.9rem',
                    ml: 1.5,
                    mr: 0.5
                  }}
                >
                  {index + 11}
                </Box>
                {rule}
              </Typography>
            </Box>
          ))}
        </Box>
      </Paper>

      {/* Warning Box */}
      <Paper 
        elevation={3}
        sx={{ 
          p: 4, 
          borderRadius: 3,
          background: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
          color: 'white'
        }}
      >
        <Stack direction="row" alignItems="center" spacing={2} mb={2}>
          <Typography fontSize={40}>โ๏ธ</Typography>
          <Typography variant="h5" fontWeight={700}>
            ุชูุจูู ููู
          </Typography>
        </Stack>
        <Box sx={{ bgcolor: 'rgba(255,255,255,0.15)', p: 3, borderRadius: 2 }}>
          <Typography variant="body1" sx={{ direction: 'rtl', textAlign: 'right', lineHeight: 1.8, mb: 2 }}>
            ุนุฏู ุงูุงูุชุฒุงู ุจูุฐู ุงูููุงุนุฏ ูุฏ ูุคุฏู ุฅูู ุงุชุฎุงุฐ ุฅุฌุฑุงุกุงุช ุชุฃุฏูุจูุฉ ุชุชุฑุงูุญ ุจูู ุงูุชุญุฐูุฑ ูุงูุญุธุฑ ุงูููุงุฆู ูู ุงููุฌููุนุฉ.
          </Typography>
          <Typography variant="body2" sx={{ direction: 'rtl', textAlign: 'right', opacity: 0.95 }}>
            ๐ก ุฌููุน ุงููุฑุงุฑุงุช ุงูููุงุฆูุฉ ุชุนูุฏ ูุตุงุญุจ ุงููููุน ูุตุงุญุจ ุงููุฌููุนุฉ.
          </Typography>
        </Box>
      </Paper>
    </Container>
  )
}
